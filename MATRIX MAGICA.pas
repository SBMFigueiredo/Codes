PROGRAM MATRIX_ISSUES;

LABEL JUNINHO;

VAR

X: ARRAY[1..1000,1..1000] OF INTEGER;
SOMA_DAS_LINHAS: ARRAY[1..1000] OF INTEGER;
SOMA_DAS_COLUNAS: ARRAY[1..1000] OF INTEGER;
A,B,C,D,E,F,G,LINHA,COLUNA: INTEGER;


BEGIN

WRITE('INSIRA O TAMANHO DA LINHA: ');
READLN(LINHA);
WRITE('INSIRA O TAMANHO DA COLUNA: ');
READLN(COLUNA);


JUNINHO:
FOR A:=1 TO (LINHA) DO

	BEGIN
	
	FOR B:=1 TO (COLUNA) DO 
	
		BEGIN
		
		X[A,B]:= RANDOM(LINHA*COLUNA)+1;
		
		FOR C:=1 TO LINHA DO
		
			BEGIN
			
			FOR D:=1 TO COLUNA DO
			
				BEGIN
				
				IF (A<>C) OR (B<>D) THEN
					
					BEGIN 
			
					IF X[A,B]=X[C,D] THEN
				
						BEGIN
					
						X[A,B]:= RANDOM(LINHA*COLUNA)+1;
						C:=1;
						D:=1;
					
						END;
				  
					END;
				
				END;
			
			END;
		
		END;
	
	END;




FOR A:=1 TO LINHA DO

	BEGIN

	FOR B:=1 TO COLUNA DO SOMA_DAS_LINHAS[A]:=SOMA_DAS_LINHAS[A]+X[A,B];
	
	END;

FOR B:=1 TO COLUNA DO

	BEGIN

	FOR A:=1 TO LINHA DO SOMA_DAS_COLUNAS[B]:=SOMA_DAS_LINHAS[B]+X[A,B];
	
	END;




FOR A:=2 TO LINHA DO 
	
	BEGIN
	
	IF SOMA_DAS_LINHAS[A]<>SOMA_DAS_LINHAS[A-1] THEN 

		BEGIN 

		FOR B:=1 TO LINHA DO SOMA_DAS_LINHAS[B]:=0;
		FOR B:=1 TO LINHA DO SOMA_DAS_COLUNAS[B]:=0;
		GOTO JUNINHO;

		END;
	
	END;

FOR A:=2 TO COLUNA DO 

	BEGIN
	
	IF SOMA_DAS_COLUNAS[A]<>SOMA_DAS_COLUNAS[A-1] THEN 
	
		BEGIN
		
		FOR B:=1 TO LINHA DO SOMA_DAS_COLUNAS[B]:=0;
		FOR B:=1 TO LINHA DO SOMA_DAS_LINHAS[B]:=0;
		GOTO JUNINHO;
	
	  END;

	END;

IF  SOMA_DAS_COLUNAS[1]<>SOMA_DAS_LINHAS[1] THEN GOTO JUNINHO;



FOR A:=1 TO LINHA DO

	BEGIN
	
	WRITE('| ',X[A,1],' ');
	FOR B:=2 TO (COLUNA-1) DO WRITE(X[A,B],' ');
	WRITELN(X[A,COLUNA],' |');
	
	END;




END.
